webpackJsonp([26],{"093F":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});a("FZuG");let i=a("09cW");var o={name:"Recharge",data:()=>({loading:!1,tableDatas:[],payTypeModal:!1,loadingTimer:null,loadingTimerDuration:5e3,cancel:{modal:!1,value:"",sn:""},audio:{src:i,open:"open"===localStorage.getItem("order/withdraw/audio/open/status")}}),computed:{tableColumns(){let e=this,t=[];return t.push({title:this.$t("uc.otcorder.orderno"),key:"orderSn",minWidth:60,align:"center",render:function(t,a){return t("p",[t("a",{on:{click:function(){e.$router.push("/chat?tradeId="+a.row.orderSn)}},class:"vc-text--link"},a.row.orderSn)])}}),t.push({title:this.$t("uc.otcorder.created"),key:"createTime",minWidth:90,align:"center"}),t.push({title:this.$t("uc.otcorder.tradename"),key:"name",ellipsis:"true",align:"center",render:function(t,a){return t("p",[t("a",{on:{click:function(){e.$router.push("/checkuser?id="+a.row.name)}},class:"vc-text--link"},a.row.name)])}}),t.push({title:this.$t("uc.otcorder.amount"),key:"amount",align:"center"}),t.push({title:this.$t("uc.otcorder.money"),key:"money",align:"center"}),t.push({title:"备注",key:"payRemark",align:"center"}),t.push({title:"支付方式",key:"payMode",align:"center"}),t.push({title:"操作",key:"done",align:"center",render:(t,a,i)=>a.row&&1==a.row.type?t("p",[t("Button",{on:{click:function(){e.cancel.modal=!0,e.cancel.sn=a.row&&a.row.orderSn}},props:{type:"warning"},style:{marginRight:"8px",marginBottom:"8px"}},"确认放币")]):t("span",{class:"vc-text--danger"},"等待放币")}),t}},mounted(){this.initPage()},methods:{initPage(){this.getOrder(!0),this.setLoadingTimer()},cancelOrderPay(e){},setLoadingTimer(){this.clearLoadingTimer(),this.loadingTimer=setInterval(()=>{this.getOrder(!1)},this.loadingTimerDuration)},clearLoadingTimer(){clearInterval(this.loadingTimer),this.loadingTimer=null},cancelOrder(){var e={orderSn:this.cancel.sn,jyPassword:this.cancel.value};""!=e.jyPassword?this.$http.post(this.host+"/otc/order/release",e).then(e=>{var t=e.body;0==t.code?(this.$Message.success(t.message),this.initPage()):this.$Message.error(t.message)}):this.$Message.error(this.$t("otc.chat.msg7tip"))},getOrder(e=!1){this.loading=e;this.$http.post(this.host+"/otc/order/goToConfirm").then(e=>{var t=e.body;0===t.code&&t.data?(this.tableDatas=t.data,this.isEmergeNewOrder()):this.$Message.error(t.message),this.loading=!1})},isEmergeNewOrder(){let e=0;this.tableDatas.forEach(t=>{e=Math.max(e,t.orderId)});let t=localStorage.getItem("order/withdraw/new/unique/id")||0;localStorage.setItem("order/withdraw/new/unique/id",e),t<e&&this.audio.open&&this.playAudio()},playAudio:function(){var e=document.getElementById("noticeMusic");null!==e&&e.play()}},watch:{"audio.open"(e){localStorage.setItem("order/withdraw/audio/open/status",e?"open":"close")}},beforeDestroy(){this.clearLoadingTimer()}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"nav-rights"},[a("div",{staticStyle:{"margin-bottom":"10px","text-align":"center",overflow:"hidden"}},[a("span",{staticClass:"vui-color--danger"},[e._v("\n      用户正在付款，请在确认收到买家付款后及时点击【确认放币】，否则请勿点击\n    ")]),e._v(" "),a("span",{staticStyle:{float:"right"}},[a("Checkbox",{model:{value:e.audio.open,callback:function(t){e.$set(e.audio,"open",t)},expression:"audio.open"}},[e._v("\n        "+e._s(e.audio.open?"关闭":"开启")+"新订单消息提醒")])],1)]),e._v(" "),a("audio",{attrs:{id:"noticeMusic",src:e.audio.src}},[e._v("\n    您的浏览器不支持 audio 标签。\n  ")]),e._v(" "),a("div",{staticClass:"nav-right"},[a("div",{staticClass:"bill_box_order"},[a("div",[a("Table",{attrs:{"no-data-text":"暂无卖出订单",columns:e.tableColumns,data:e.tableDatas,loading:e.loading,"disabled-hover":!0}})],1)])]),e._v(" "),a("Modal",{staticClass:"ivu-modal--left",attrs:{title:"提示","mask-closable":!1,width:"400px"},on:{"on-ok":function(t){e.cancelOrder()}},model:{value:e.cancel.modal,callback:function(t){e.$set(e.cancel,"modal",t)},expression:"cancel.modal"}},[a("div",{},[a("div",{staticClass:"vui-margin-bottom"},[a("span",{staticClass:"vui-color--danger"},[e._v("是否确认放币？")])]),e._v(" "),a("div",[a("Input",{attrs:{type:"password",placeholder:"请输入资金交易密码",autocomplete:"off"},model:{value:e.cancel.value,callback:function(t){e.$set(e.cancel,"value",t)},expression:"cancel.value"}})],1)])])],1)},staticRenderFns:[]};var n=a("VU/8")(o,r,!1,function(e){a("Pe8A")},null,null);t.default=n.exports},Pe8A:function(e,t){}});