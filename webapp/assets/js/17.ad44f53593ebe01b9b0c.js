webpackJsonp([17],{BGdy:function(t,e){},jDKi:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("ieju");const a=s.d.find(t=>"number-money"===t.type).value;var l={components:{},data(){let t=this;return{edit:{popup:!1,type:"insert",id:"",advertiseType:"1",number:"",payMode:"",maxLimit:"",payModeList:[],password:"",base:{limit:0,balance:0,leftBuyLimit:0,leftSellLimit:0}},loginmsg:this.$t("common.logintip"),dataCount:0,tableAdv:[],loading:!0,tableColumnsAdv:[{title:t.$t("otc.myad.no"),key:"id",width:55,align:"center"},{title:t.$t("otc.myad.type"),key:"advertiseType",width:90,align:"center",render:(e,i)=>{let s="";return 0==i.row.advertiseType?s=t.$t("otc.myad.buy"):1==i.row.advertiseType&&(s=t.$t("otc.myad.sell")),e("div",[e("p",s)])}},{title:t.$t("otc.myad.limit"),key:"limit",width:100,align:"center",render:(t,e)=>t("div",[t("p",e.row.minLimit+"~"+e.row.maxLimit)])},{title:t.$t("otc.myad.remain"),key:"remainAmount",width:90,align:"center"},{title:t.$t("otc.myad.coin"),key:"coinUnit",width:100,align:"center"},{title:"支付/收款方式",key:"payMode",width:100,align:"center"},{title:t.$t("otc.myad.created"),key:"createTime",width:160,align:"center"},{title:t.$t("otc.myad.operate"),key:"buyBtn",width:180,align:"center",render:function(e,i){return e("p",[e("a",{on:{click:function(){0==i.row.status?t.$Message.error(t.$t("otc.myad.errmsg")):t.beforePublish("update",i.row)}}},[e("Button",{props:{size:"small"},style:{marginRight:"8px"}},t.$t("otc.myad.update"))]),e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"8px"},on:{click:()=>{if(1==i.row.status){let e={};e.id=i.row.id,t.$http.post(t.host+"/otc/advertise/on/shelves",e).then(e=>{var i=e.body;0==i.code?(t.$Message.success(i.message),t.getAd()):t.$Message.error(i.message)})}else if(0==i.row.status){let e={};e.id=i.row.id,t.$http.post(t.host+"/otc/advertise/off/shelves",e).then(e=>{var i=e.body;0==i.code?(t.$Message.success(i.message),t.getAd()):t.$Message.error(i.message)})}}}},0==i.row.status?t.$t("otc.myad.dropoff"):t.$t("otc.myad.shelf")),e("Button",{props:{type:"error",size:"small"},on:{click:()=>{let e={};e.id=i.row.id,1==i.row.status?t.$Modal.confirm({title:t.$t("common.tip"),content:"<p>"+t.$t("common.delete")+"</p>",onOk:()=>{t.$http.post(t.host+"/otc/advertise/delete",e).then(e=>{var s=e.body;0==s.code?(t.$Message.success(s.message),t.remove(i.index)):t.$Message.error(s.message)})}}):t.$Message.error("下架广告后才可以删除！")}}},t.$t("otc.myad.delete"))])}}],totalPage:0,pageNumber:10,currentPage:1}},methods:{sureSave(){let t=new s.a;if(t.set(this.edit.number+"",!0,"请输入交易数量").check("交易数量格式错误，请输入合法的金额格式",t=>a.test(t)).check("交易数量不小于100",t=>t-0>=100).check("交易数量不能大于可用额度",t=>"1"===this.edit.advertiseType?t-0<=this.edit.base.leftSellLimit-0:t-0<=this.edit.base.leftBuyLimit-0).set(this.edit.maxLimit+"").check("最大交易额格式错误，请输入合法的金额格式",t=>a.test(t)).check("最大交易额不小于100",t=>t-0>=100).check("最大交易额不能大于交易数量",t=>t-0<=this.edit.number-0).set(this.edit.payMode,!0,"请选择收款方式").set(this.edit.password,!0,"请输入资金密码"),t.pass){let t={number:this.edit.number,pay:[this.edit.payMode],jyPassword:this.edit.password,maxLimit:this.edit.maxLimit,advertiseType:this.edit.advertiseType};"insert"==this.edit.type?this.$http.post(this.host+"/otc/advertise/createStable",t).then(t=>{var e=t.body;0==e.code?(this.$Message.success(e.message),this.edit.popup=!1,this.edit.number="",this.edit.payMode="",this.edit.maxLimit="",this.getAd()):this.$Message.error(e.message)}):(t.id=this.edit.id,this.$http.post(this.host+"/otc/advertise/updateStable",t).then(t=>{var e=t.body;0==e.code?(this.$Message.success(e.message),this.edit.popup=!1,this.edit.number="",this.edit.payMode="",this.edit.maxLimit="",this.getAd()):this.$Message.error(e.message)}))}else this.$Message.error(t.message)},beforePublish(t,e){this.edit.type=t,"update"===t&&(this.edit.number=e.number,this.edit.maxLimit=e.maxLimit,this.edit.payMode=(e.payMode+"").split(",")[0],this.edit.advertiseType=e.advertiseType+"",this.edit.id=e.id+""),this.edit.popup=!0,this.getMember(),this.getAccount(),this.getBaseMessage()},getMember(){this.$http.get(this.host+this.api.uc.identification).then(t=>{2==t.body.data.certifiedBusinessStatus||(this.$Message.warning("请先申请商家认证!"),this.$router.push("/identbusiness"))})},getBaseMessage(){this.$http.post(this.host+"/otc/advertise/init").then(t=>{var e=t.body;0===e.code?e.data?this.edit.base=Object.assign(this.edit.base,e.data):this.$Message.error("获取用户剩余额度等信息失败！"):this.$Message.error(e.message)})},getAccount(){this.$http.post(this.host+"/uc/approve/account/setting").then(t=>{var e=t.body;if(0==e.code){this.edit.payModeList=[];let t=(e.data||[]).filter(t=>1===t.checked);t.findIndex(t=>1===t.type)>-1&&this.edit.payModeList.push({label:"银联",value:"银联"}),t.findIndex(t=>2===t.type)>-1&&this.edit.payModeList.push({label:"微信",value:"微信"}),t.findIndex(t=>3===t.type)>-1&&this.edit.payModeList.push({label:"支付宝",value:"支付宝"}),t.findIndex(t=>4===t.type)>-1&&this.edit.payModeList.push({label:"云闪付",value:"云闪付"}),t.findIndex(t=>5===t.type)>-1&&this.edit.payModeList.push({label:"聚合码",value:"聚合码"})}else this.$Message.error(e.message)})},updateLangData(){this.tableColumnsAdv[0].title=this.$t("otc.myad.no"),this.tableColumnsAdv[1].title=this.$t("otc.myad.type"),this.tableColumnsAdv[2].title=this.$t("otc.myad.limit"),this.tableColumnsAdv[3].title=this.$t("otc.myad.remain"),this.tableColumnsAdv[4].title=this.$t("otc.myad.coin"),this.tableColumnsAdv[5].title=this.$t("otc.myad.created"),this.tableColumnsAdv[6].title=this.$t("otc.myad.operate")},remove(t){this.tableAdv.splice(t,1)},banding(){this.$router.push("/uc/account")},changePage(){},getAd(){this.$http.post(this.host+"/otc/advertise/all").then(t=>{var e=t.body;if(0==e.code){this.tableAdv=e.data.content;for(var i=0;i<this.tableAdv.length;i++)this.tableAdv[i].coinUnit=this.tableAdv[i].coin.unit;this.loading=!1,this.totalPage=e.data.totalElements}else this.$Message.error(this.loginmsg)})},publish(t){"coin"==t?this.$router.push(this.api.otc.createCoin):this.$router.push(this.api.otc.createAd)}},computed:{lang:function(){return this.$store.state.lang}},watch:{lang:function(){this.updateLangData()}},created(){this.getAd()}},d={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"nav-rights"},[i("Modal",{staticClass:"ivu-modal--left",attrs:{"mask-closable":!1,width:"400px",title:"insert"===t.edit.type?"发布广告":"修改广告"},model:{value:t.edit.popup,callback:function(e){t.$set(t.edit,"popup",e)},expression:"edit.popup"}},[i("div",{staticClass:"vui-padding--large"},[i("div",[i("div",{staticClass:"vui-row--flex vui-align-items--flex-start vui-margin-bottom--large"},[i("div",{staticClass:"vui-span--6 vui-text-align--right vui-padding-right--large"},[i("span",{staticClass:"vui-color--label"},[t._v("温馨提示")])]),t._v(" "),i("div",{staticClass:"vui-span--18"},[i("div",{staticClass:"vui-margin-bottom"},[i("span",{staticClass:"vui-color--danger"},[t._v("承兑额度=出售或购买的上限")])]),t._v(" "),i("div",{staticClass:"vui-margin-bottom"},[i("span",{staticClass:"vui-color--danger"},[t._v("承兑额度增加=用其他数字货币兑换TTM会增加TTM数量的额度")])]),t._v(" "),i("div",{staticClass:"vui-margin-bottom"},[i("span",{staticClass:"vui-color--danger"},[t._v("承兑额度的减少=用TTM兑换其他数字货币会减少TTM数量的额度")])])])]),t._v(" "),i("div",{staticClass:"vui-row--flex vui-align-items--center vui-margin-bottom--large"},[i("div",{staticClass:"vui-span--6 vui-text-align--right vui-padding-right--large"},[i("span",{staticClass:"vui-color--label"},[t._v("承兑额度")])]),t._v(" "),i("div",{staticClass:"vui-span--18"},[i("span",{staticClass:"vui-color--primary"},[t._v(t._s(t.edit.base.limit))])])]),t._v(" "),i("div",{staticClass:"vui-row--flex vui-align-items--center vui-margin-bottom--large"},[i("div",{staticClass:"vui-span--6 vui-text-align--right vui-padding-right--large"},[i("span",{staticClass:"vui-color--label"},[t._v("余额")])]),t._v(" "),i("div",{staticClass:"vui-span--18"},[i("span",{staticClass:"vui-color--primary"},[t._v(t._s(t.edit.base.balance))])])]),t._v(" "),i("div",{staticClass:"vui-row--flex vui-align-items--center vui-margin-bottom--large"},[i("div",{staticClass:"vui-span--6 vui-text-align--right vui-padding-right--large"},[i("span",{staticClass:"vui-color--danger"},[t._v("*")]),i("span",{staticClass:"vui-color--label"},[t._v("我想要")])]),t._v(" "),i("div",{staticClass:"vui-span--18"},[i("RadioGroup",{model:{value:t.edit.advertiseType,callback:function(e){t.$set(t.edit,"advertiseType",e)},expression:"edit.advertiseType"}},[i("Radio",{attrs:{label:"1",disabled:"update"===t.edit.type}},[t._v("在线出售")]),t._v(" "),i("Radio",{attrs:{label:"0",disabled:"update"===t.edit.type}},[t._v("在线购买")])],1)],1)]),t._v(" "),i("div",{staticClass:"vui-row--flex vui-align-items--center vui-margin-bottom--large"},[i("div",{staticClass:"vui-span--6 vui-text-align--right vui-padding-right--large"},[i("span",{staticClass:"vui-color--danger"},[t._v("*")]),i("span",{staticClass:"vui-color--label"},[t._v("交易数量")])]),t._v(" "),i("div",{staticClass:"vui-span--18"},[i("div",[i("i-input",{attrs:{placeholder:"请输入您的交易数量",autocomplete:"off"},model:{value:t.edit.number,callback:function(e){t.$set(t.edit,"number",e)},expression:"edit.number"}})],1),t._v(" "),i("div",{staticClass:"vui-margin-top"},["1"===t.edit.advertiseType?i("div",[i("span",{staticClass:"vui-color--danger"},[t._v("提示：可出售额度")]),t._v(" "),i("span",{staticClass:"vui-color--primary"},[t._v(t._s(t.edit.base.leftSellLimit))]),t._v(" "),i("span",{staticClass:"vui-color--danger"},[t._v(",交易数量不小于100")])]):i("div",[i("span",{staticClass:"vui-color--danger"},[t._v("提示：可购买额度")]),t._v(" "),i("span",{staticClass:"vui-color--primary"},[t._v(t._s(t.edit.base.leftBuyLimit))]),t._v(" "),i("span",{staticClass:"vui-color--danger"},[t._v(",交易数量不小于100")])])])])]),t._v(" "),t._e(),t._v(" "),i("div",{staticClass:"vui-row--flex vui-align-items--center vui-margin-bottom--large"},[i("div",{staticClass:"vui-span--6 vui-text-align--right vui-padding-right--large"},[i("span",{staticClass:"vui-color--label"},[t._v("最大交易额")])]),t._v(" "),i("div",{staticClass:"vui-span--18"},[i("i-input",{attrs:{placeholder:"请输入您的最大交易额",autocomplete:"off"},model:{value:t.edit.maxLimit,callback:function(e){t.$set(t.edit,"maxLimit",e)},expression:"edit.maxLimit"}})],1)]),t._v(" "),i("div",{staticClass:"vui-row--flex vui-align-items--center vui-margin-bottom--large"},[i("div",{staticClass:"vui-span--6 vui-text-align--right vui-padding-right--large"},[i("span",{staticClass:"vui-color--danger"},[t._v("*")]),t._v(" "),i("span",{staticClass:"vui-color--label"},[t._v("付款方式")])]),t._v(" "),i("div",{staticClass:"vui-span--18"},[i("div",{staticClass:"vui-flex vui-align-items--center"},[i("div",{staticClass:"vui-flex--1"},[i("Select",{model:{value:t.edit.payMode,callback:function(e){t.$set(t.edit,"payMode",e)},expression:"edit.payMode"}},t._l(t.edit.payModeList,function(e){return i("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}))],1),t._v(" "),i("div",{staticClass:"vui-margin-left"},[i("i-button",{on:{click:t.banding}},[t._v("绑定")])],1)])])]),t._v(" "),i("div",{staticClass:"vui-row--flex vui-align-items--center"},[i("div",{staticClass:"vui-span--6 vui-text-align--right vui-padding-right--large"},[i("span",{staticClass:"vui-color--danger"},[t._v("*")]),i("span",{staticClass:"vui-color--label"},[t._v("资金密码")])]),t._v(" "),i("div",{staticClass:"vui-span--18"},[i("i-input",{attrs:{type:"password",placeholder:"请输入您的资金密码..."},model:{value:t.edit.password,callback:function(e){t.$set(t.edit,"password",e)},expression:"edit.password"}})],1)])])]),t._v(" "),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("i-button",{attrs:{type:"default"},on:{click:function(e){t.edit.popup=!1}}},[t._v("取消")]),t._v(" "),i("i-button",{attrs:{type:"primary"},on:{click:t.sureSave}},[t._v("保存")])],1)]),t._v(" "),i("div",{staticClass:"my_ad_box"},[i("div",{staticClass:"add_ad vui-flex "},[t._m(0),t._v(" "),i("div",[i("Button",{attrs:{icon:"ios-add-circle",type:"primary"},on:{click:function(e){t.beforePublish("insert")}}},[t._v("\n          发布广告\n        ")]),t._v(" "),i("Button",{attrs:{icon:"ios-build",type:"success"},on:{click:t.banding}},[t._v("\n          账号设置\n        ")])],1)]),t._v(" "),t._e(),t._v(" "),i("div",{staticClass:"order-table"},[i("Table",{staticClass:"tables",attrs:{columns:t.tableColumnsAdv,data:t.tableAdv,"no-data-text":t.$t("common.nodata"),loading:t.loading,"disabled-hover":!0}}),t._v(" "),i("div",{staticStyle:{margin:"10px",overflow:"hidden"},attrs:{id:"pages"}},[i("div",{staticStyle:{float:"right"}},[t.totalPage>0?i("Page",{attrs:{pageSize:t.pageNumber,total:t.totalPage,current:t.currentPage},on:{"on-change":t.changePage}}):t._e()],1)])],1)],2)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"vui-flex--1 vui-center"},[e("div",[e("div",{staticClass:"vui-color--danger vui-line-height--medium"},[this._v("\n            当广告最小交易额所购买数量加上手续费大于广告剩余数量，该广告自动下架\n          ")]),this._v(" "),e("div",{staticClass:"vui-color--danger vui-line-height--medium"},[this._v("\n            一种支付或收款方式分别最多可以上架一个在线出售和在线够买广告\n          ")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"vui-margin-bottom"},[e("div",{staticClass:"vui-font-weight--800 vui-color--danger  vui-line-height--medium"},[this._v("\n          温馨提示:\n        ")]),this._v(" "),e("div",{staticClass:"vui-color--danger vui-line-height--medium"},[this._v("\n          当广告最小交易额所购买数量加上手续费大于广告剩余数量，该广告自动下架\n        ")]),this._v(" "),e("div",{staticClass:"vui-color--danger vui-line-height--medium"},[this._v("\n          一种支付或收款方式分别最多可以上架一个在线出售和在线够买广告\n        ")])])}]};var o=i("VU/8")(l,d,!1,function(t){i("sr5o"),i("BGdy")},"data-v-3c1dbc28",null);e.default=o.exports},sr5o:function(t,e){}});