webpackJsonp([25],{gPfZ:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});a("FZuG");let i=a("09cW");var s={name:"Recharge",data:()=>({loading:!1,content:{scanOrders:[],payModeData:{},sort:[]},payTypeModal:!1,loadingTimer:null,loadingTimerDuration:5e3,payInfo:[],withdraw:{modal:!1,value:"",sn:"",timer:null,backtime:0},recharge:{modal:!1,value:"",sn:""},payCode:{value:"",size:300,backgroundAlpha:1,background:"white",foreground:"black",level:"L"},audio:{src:i,open:"open"===localStorage.getItem("order/withdraw/audio/open/status")},online:{timer:null,backtime:0}}),computed:{tableColumns(){let t=this,e=[];return e.push({title:"订单号",key:"orderSn",minWidth:60,align:"center",render:function(e,a){return e("p",[e("a",{on:{click:function(){t.$router.push("/chat?tradeId="+a.row.orderSn)}},class:"vc-text--link"},a.row.orderSn)])}}),e.push({title:"订单类型",key:"type",align:"center",render:(t,{row:e})=>{if("customer"===e.orderType)return t("p",{style:{color:"red","font-weight":800}},"申诉订单")}}),e.push({title:"交易类型",key:"type",align:"center",render:(t,e)=>{let a="";return t("div",a=0===e.row.type?"买入":"卖出")}}),e.push({title:"创建时间",key:"createTime",minWidth:90,align:"center"}),e.push({title:"交易对象",key:"name",ellipsis:"true",align:"center",render:function(t,{row:e}){if("customer"!==e.orderType)return t("p",e.name)}}),e.push({title:"数量",key:"amount",align:"center"}),e.push({title:"金额",key:"money",align:"center"}),e.push({title:"备注",key:"payRemark",align:"center"}),e.push({title:"支付/收款方式",key:"payMode",align:"center"}),e.push({title:"操作",key:"done",align:"center",render(e,a,i){let s=a.row;if(null==s)return!1;if("customer"===s.orderType)return e("p",[e("Button",{on:{click:function(){localStorage.setItem("app/order/custom/message",JSON.stringify(a.row)),t.$router.push("/chat?tradeId="+a.row.orderSn+"&type=custom")}},props:{type:"error"},style:{marginRight:"8px",marginBottom:"8px"}},"去处理")]);if(1===s.type){if(1===s.status)return e("p",{style:{color:"red"}},"等待付款");if(2===s.status)return e("p",[e("Button",{on:{click:function(){t.withdraw.modal=!0,t.withdraw.backtime=5,t.setReleaseTimer(),t.withdraw.sn=a.row&&a.row.orderSn}},props:{type:"warning"},style:{marginRight:"8px",marginBottom:"8px"}},"确认放币")])}else if(0===s.type)return 1===s.status?e("p",[e("Button",{on:{click:function(){let e=a.row&&a.row.orderSn;t.recharge.money=a.row&&a.row.money,t.recharge.sn=e,t.getOrderDatail(e)}},props:{type:"success"},style:{marginRight:"8px",marginBottom:"8px"}},"去付款")]):e("p",{style:{color:"red"}},"等待放行")}}),e}},mounted(){this.initPage()},methods:{initPage(){this.getOrder(!0),this.setLoadingTimer()},setLoadingTimer(){this.clearLoadingTimer(),this.loadingTimer=setInterval(()=>{this.getOrder(!1)},this.loadingTimerDuration)},clearLoadingTimer(){clearInterval(this.loadingTimer),this.loadingTimer=null},beforeRelease(){this.withdraw.modal=!0,this.withdraw.backtime=5,this.setReleaseTimer()},setReleaseTimer(){this.clearReleaseTimer(),this.withdraw.timer=setInterval(()=>{this.withdraw.backtime--,0===this.withdraw.backtime&&this.clearReleaseTimer()},1e3)},clearReleaseTimer(){clearInterval(this.withdraw.timer),this.withdraw.timer=null},cancelOrder(t){if("withdraw"===t){var e={orderSn:this.withdraw.sn,jyPassword:this.withdraw.value};if(""==e.jyPassword)return void this.$Message.error("请输入交易密码");this.$http.post(this.host+"/otc/order/release",e).then(t=>{var e=t.body;0==e.code?(this.$Message.success(e.message),this.withdraw.modal=!1,this.initPage()):this.$Message.error(e.message)})}else this.$http.post(this.host+"/otc/order/pay",{orderSn:this.recharge.sn}).then(t=>{var e=t.body;0==e.code?(this.$Message.success(e.message),this.recharge.modal=!1,this.recharge.sn="",this.initPage()):this.$Message.error(e.message)})},getOrderDatail(t){this.$http.post(this.host+"/otc/order/detail",{orderSn:t}).then(t=>{var e=t.body;if(0==e.code&&e.data.payInfo){let t=e.data.payInfo;this.payInfo=[];let a=e.data.payMode&&e.data.payMode.split(",");if(a.indexOf("支付宝")>-1&&t.alipay){let e={title:t.alipay.alipay,value:t.alipay.alipayUrl,value2:t.alipay.alipayCodeUrl,realName:t.alipay.alipayRealName,key:"ali",type:"支付宝"};this.payInfo.push(e)}if(a.indexOf("银联")>-1&&t.bankInfo){let e={key:"card",type:"银行卡",title:t.bankInfo.bankRealName,value:t.bankInfo.cardNo,value2:t.bankInfo.bank};this.payInfo.push(e)}if(a.indexOf("微信")>-1&&t.wechatPay){let e={type:"微信",key:"wx",title:t.wechatPay.wechat,value:t.wechatPay.wechatUrl,value2:t.wechatPay.qrWeCodeUrl};this.payInfo.push(e)}if(a.indexOf("云闪付")>-1&&t.unionpay){let e={type:"云闪付",key:"unionpay",title:t.unionpay.unionpay,value:t.unionpay.unionpayUrl,value2:t.unionpay.unionpayCodeUrl};this.payInfo.push(e)}this.recharge.modal=!0}else this.$Message.error("获取付款方式失败！"),this.recharge.modal=!1})},getOrder(t=!1){this.loading=t,this.$http.post(this.host+"/otc/order/goToPayOrConfirm").then(({body:t})=>{this.loading=!1;let{code:e,data:a,message:i}=t;if(0===e&&a){let{scanOrders:t,payModeData:e,sort:i,appealOrders:s}=a,r=[];t.forEach(t=>{r.push(Object.assign(t,{orderType:"sellBuy"}))}),s.forEach(t=>{r.push(Object.assign(t,{orderType:"customer"}))}),this.content.scanOrders=r,this.content.sort=i;let n=[];Object.keys(e).forEach(t=>{n.push({text:t,value:e[t]})}),this.content.payModeData=n}else this.loading=!1,this.$Message.error(i)})},getCostomer(){},playAudio:function(){var t=document.getElementById("noticeMusic");null!==t&&t.play()},setOnline(){this.$http.post(this.host+"/uc/member/online").then(({body:t})=>{let{code:e,data:a,message:i}=t;0===e?(this.getOrder(),this.setOnlineTimer()):this.$Message.error(i)})},setOnlineTimer(){this.clearOnlineTimer(),this.online.backtime=3e5,this.online.timer=setInterval(()=>{this.online.backtime-=1e3,0===this.online.backtime&&this.clearOnlineTimer()},1e3)},clearOnlineTimer(){clearInterval(this.online.timer),this.online.timer=null},formatTime(t){let e=Math.floor(t/36e5),a=Math.floor((t-36e5*e)/6e4),i=Math.floor((t-36e5*e-6e4*a)/1e3);function s(t){return Number(t)>9?t:"0"+t}return e>0?`${e}时${s(a)}分${s(i)}秒`:a>0?`${s(a)}分${s(i)}秒`:i>0?`${s(i)}秒`:0}},watch:{"audio.open"(t){localStorage.setItem("order/withdraw/audio/open/status",t?"open":"close")},"withdraw.modal"(){this.withdraw.value=""}},beforeDestroy(){this.clearLoadingTimer()}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"nav-rights"},[t._e(),t._v(" "),[a("div",{staticStyle:{"line-height":"36px"}},[t._m(0),t._v(" "),a("div",{staticClass:" vi-padding-left is-padding-left--larger"},[a("div",{staticClass:"vi-flex"},t._l(t.content.payModeData,function(e,i){return a("div",{staticClass:"vi-margin-right is-margin-right--larger"},[a("span",{staticClass:"vi-text is-weight--bold"},[t._v(t._s(e.text)+"：")]),t._v(" "),a("span",{staticClass:"vi-text is-color--primary",staticStyle:{"font-size":"24px"}},[t._v("\n              "+t._s(e.value)+"\n            ")])])}))])])],t._v(" "),t.content.sort.length>0?[a("div",{staticClass:"vi-margin-top",staticStyle:{"line-height":"36px"}},[t._m(1),t._v(" "),a("div",{staticClass:"vi-padding-left is-padding-left--larger"},[t._l(t.content.sort,function(e,i){return a("div",{staticClass:"vi-flex"},[a("div",{staticClass:"vi-margin-right is-margin-right--larger"},[a("span",{staticClass:" vi-text is-weight--bold"},[t._v("\n              类型：\n            ")]),t._v(" "),a("span",{staticClass:"vi-text  "},[t._v("\n              "+t._s(1===e.advertiseType?"在线出售":"在线购买")+"\n            ")])]),t._v(" "),a("div",{staticClass:"vi-margin-right is-margin-right--larger"},[a("span",{staticClass:" vi-text is-weight--bold"},[t._v("\n              方式：\n            ")]),t._v(" "),a("span",{staticClass:"vi-text "},[t._v("\n              "+t._s(e.payMode)+"\n            ")])]),t._v(" "),a("div",{staticClass:"vi-margin-right is-margin-right--larger"},[a("span",{staticClass:" vi-text is-weight--bold"},[t._v("\n              剩余数量|TTM：\n            ")]),t._v(" "),a("span",{staticClass:"vi-text  "},[t._v(" "+t._s(e.remainAmount)+" ")])]),t._v(" "),a("div",{staticClass:"vi-margin-right is-margin-right--larger"},[a("span",{staticClass:" vi-text is-weight--bold"},[t._v("\n              排队号：\n            ")]),t._v(" "),a("span",{staticClass:"vi-text is-color--primary",staticStyle:{"font-size":"24px"}},[t._v("\n              "+t._s(e.sortOrder)+"\n            ")])]),t._v(" "),a("div",{staticClass:"vi-margin-right is-margin-right--larger"},[a("span",{staticClass:" vi-text is-weight--bold"},[t._v("\n              抢单号：\n            ")]),t._v(" "),a("span",{staticClass:"vi-text is-color--primary",staticStyle:{"font-size":"24px"}},[t._v("\n              "+t._s(e.pickOrder||"--")+"\n            ")])])])}),t._v(" "),a("div",[0===t.online.backtime?a("i-button",{attrs:{size:"large",long:"",type:"primary"},on:{click:t.setOnline}},[t._v("\n            抢单\n          ")]):a("i-button",{attrs:{size:"large",long:"",type:"default",disabled:""}},[t._v(t._s(t.formatTime(t.online.backtime))+"后操作")])],1)],2)])]:t._e(),t._v(" "),t.content.scanOrders.length>0?[a("div",{staticClass:"vi-margin-top"},[t._m(2),t._v(" "),a("div",{staticClass:"vi-padding-left is-padding-left--larger"},[a("Table",{attrs:{"no-data-text":"暂无订单",columns:t.tableColumns,data:t.content.scanOrders,loading:t.loading,"disabled-hover":!0}})],1)])]:t._e(),t._v(" "),a("Modal",{attrs:{title:"放行提示",width:"500px"},model:{value:t.withdraw.modal,callback:function(e){t.$set(t.withdraw,"modal",e)},expression:"withdraw.modal"}},[a("div",{attrs:{slot:"footer"},slot:"footer"},[t.withdraw.backtime?a("i-button",{attrs:{type:"default"}},[t._v(t._s(t.withdraw.backtime)+"秒后操作")]):a("i-button",{attrs:{type:"primary"},on:{click:function(e){t.cancelOrder("withdraw")}}},[t._v("确认放行")])],1),t._v(" "),a("div",{staticClass:"vui-margin-bottom"},[a("p",{staticClass:"vui-color--danger vui-font-weight--bold"},[t._v("温馨提示")]),t._v(" "),a("p",{staticClass:"vui-color--danger",staticStyle:{"text-indent":"20px","line-height":"36px"}},[t._v("\n        一、最近骗子猖獗，请再次核对金额，金额正确才放行，没有收到款或者收到金额不符款项，请务放行，\n        有任何问题请及时联系客服处理。\n      ")]),t._v(" "),a("p",{staticClass:"vui-color--danger",staticStyle:{"text-indent":"40px","line-height":"36px"}},[t._v("\n        例如：付款方会更改自己的昵称，**通过扫码向你付款5000.00元，来迷惑收款方，其实付款方只付款了0.1元，\n        已经有多名币商被骗，请一定要谨慎操作\n      ")]),t._v(" "),a("p",{staticClass:"vui-color--danger",staticStyle:{"text-indent":"20px","line-height":"36px"}},[t._v("\n        二、自己不认真核对金额造成损失的，损失由自己承担。\n      ")]),t._v(" "),a("p",{staticClass:"vui-color--danger",staticStyle:{"text-indent":"20px","line-height":"36px"}},[t._v("\n        三、请谨慎放行，确认收到款项再放行，确认收到款项再放行，确认收到款项再放行。\n      ")])]),t._v(" "),a("P",{staticStyle:{color:"red","font-weight":"bold"}},[a("Input",{attrs:{type:"password",placeholder:"请输入资金交易密码",autocomplete:"off"},model:{value:t.withdraw.value,callback:function(e){t.$set(t.withdraw,"value",e)},expression:"withdraw.value"}})],1)],1),t._v(" "),t._e(),t._v(" "),a("Modal",{staticClass:"ivu-modal--left",attrs:{"mask-closable":!1,width:"400px"},model:{value:t.recharge.modal,callback:function(e){t.$set(t.recharge,"modal",e)},expression:"recharge.modal"}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("p",{staticStyle:{"text-align":"center"}},[t._v("\n        "+t._s(t.recharge.sn)+"\n      ")])]),t._v(" "),a("div",{staticClass:"vp-paytype"},[a("div",{staticClass:"vp-paytype__label"},[a("span",{staticStyle:{"font-size":"50px"}},[t._v("￥ "+t._s(t.recharge.money))])]),t._v(" "),a("div",{staticClass:"vp-paytype__body"},t._l(t.payInfo,function(e,i){return a("div",{key:i,staticClass:"vp-payType__item"},[a("span",{staticClass:"vp-text__type"},[t._v(t._s(e.type))]),t._v(" "),a("div",{staticClass:"vp-payType__content"},[a("span",{staticClass:"vp-text__title"},[t._v("\n              "+t._s(e.title)+"\n              "),e.realName?a("span",{staticClass:"vp-text__title"},[t._v("\n                ("+t._s(e.realName)+")\n              ")]):t._e()]),t._v(" "),"card"===e.key?a("span",{staticClass:"vp-text__value",staticStyle:{"font-size":"20px"}},[t._v("\n              "+t._s(e.value)+"\n            ")]):t._e(),t._v(" "),"card"===e.key?a("span",{staticClass:"vp-text__value",staticStyle:{"font-size":"20px"}},[t._v("\n              "+t._s(e.value2)+"\n            ")]):a("div",[e.value?a("div",{staticStyle:{position:"relative"}},[a("div",{staticStyle:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)","background-color":"white"}},[a("i",{staticClass:"icons ",class:{"alipay-plus":"ali"==e.key,"wechat-plus":"wx"==e.key,"unionpay-plus":"unionpay"==e.key},staticStyle:{height:"50px",width:"50px"}})]),t._v(" "),a("qriously",{attrs:{value:e.value,size:t.payCode.size,level:t.payCode.level,background:t.payCode.background,foreground:t.payCode.foreground,backgroundAlpha:t.payCode.backgroundAlpha}})],1):[e.value2?a("div",{style:{width:t.payCode.size+"px",height:t.payCode.size+"px",textAlign:"center"}},[a("img",{style:{height:"100%",width:"auto"},attrs:{src:e.value2,alt:""}})]):t._e()]],2)])])})),t._v(" "),a("div",{staticStyle:{"text-align":"center",padding:"10px"}},[a("Button",{attrs:{type:"warning"},nativeOn:{click:function(e){t.cancelOrder("recharge")}}},[t._v("完成付款")])],1)]),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"})])],2)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:" "},[e("span",{staticClass:"vi-text is-weight--bold",staticStyle:{"font-size":"16px"}},[this._v("\n          当前平台正在接单的数量\n        ")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{},[e("span",{staticClass:"vi-text is-weight--bold",staticStyle:{"font-size":"16px"}},[this._v("\n          我的广告\n        ")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticStyle:{"line-height":"32px"}},[e("span",{staticClass:"vi-text is-weight--bold",staticStyle:{"font-size":"16px"}},[this._v("\n          我的订单\n        ")])])}]};var n=a("VU/8")(s,r,!1,function(t){a("toCf")},null,null);e.default=n.exports},toCf:function(t,e){}});